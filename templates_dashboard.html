



  <!DOCTYPE html>
  <html lang="en">
  <head>
      <meta charset="UTF-8">
      
       



    <title>DevSync</title>
    <link rel="icon" href="{{ url_for('static', filename='mwt_logo.png') }}" type="image/x-icon">
      <!-- <title>{{ username }}'s Repositories</title> -->
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
      <style>

      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
  
      body {

        font-family: 'Inter', sans-serif;

        background: linear-gradient(135deg, #1e1e2f, #2a2a3b);

        min-height: 100vh;

        color: #fff;

        transition: background 0.5s ease, color 0.5s ease, transform 0.5s ease;

        perspective: 1200px;

      }
  
      .glass-container {

        background: rgba(255, 255, 255, 0.05);

        backdrop-filter: blur(20px);

        border-radius: 20px;

        border: 1px solid rgba(255, 255, 255, 0.1);

        box-shadow: 0 15px 45px rgba(0, 0, 0, 0.4);

        transform-style: preserve-3d;

        transform: rotateX(1deg);

        transition: all 0.5s ease;

      }
  
      .glass-container:hover {

        transform: rotateX(0deg) translateY(-5px);

        box-shadow: 0 25px 60px rgba(0, 0, 0, 0.6);

      }
  
      .repo-card {

        background: rgba(255, 255, 255, 0.07);

        border-radius: 16px;

        border: 1px solid rgba(255, 255, 255, 0.08);

        color: #fff;

        height: 190px;

        position: relative;

        overflow: hidden;

        transition: all 0.4s ease;

        box-shadow: inset 0 0 8px rgba(0, 255, 255, 0.15);

      }
  
      .repo-card:hover {

        transform: translateY(-10px) scale(1.02);

        box-shadow: 0 12px 24px rgba(0, 255, 255, 0.25), inset 0 0 15px rgba(0, 255, 255, 0.2);

      }
  
      .repo-card .lock-icon {

        position: absolute;

        top: 12px;

        right: 12px;

        font-size: 1.5rem;

        color: #ff6b6b;

      }
  
      .search-container {

        position: relative;

        max-width: 500px;

        margin: 30px auto 20px;

      }
  
      .search-input {

        background: rgba(255, 255, 255, 0.1);

        border: none;

        color: #fff;

        padding: 14px 50px 14px 20px;

        border-radius: 35px;

        transition: all 0.3s ease;

        box-shadow: inset 0 0 6px rgba(255, 255, 255, 0.1);

      }
  
      .search-input:focus {

        background: rgba(255, 255, 255, 0.15);

        box-shadow: 0 0 12px rgba(0, 201, 167, 0.6);

      }
  
      .dropdown-menu {

        background-color: #0e0e14 !important;

        border-radius: 12px;

        border: 1px solid rgba(255, 255, 255, 0.08);

        box-shadow: 0 12px 28px rgba(0, 0, 0, 0.4);

      }
  
      .dropdown-item {

        color: #fff;

        transition: all 0.3s ease;

      }
  
      .dropdown-item:hover {

        background-color: #1a1a1a;

        color: #00C9A7;

        transform: translateX(4px);

      }
  
      /* LIGHT MODE OVERRIDES WITH 3D EFFECT */

      body.light-mode {

        background: radial-gradient(circle at top left, #ffffff, #e0e0e0);

        color: #000;

        transition: background 0.7s ease-in-out, color 0.7s ease;

        transform-style: preserve-3d;

      }
  
      body.light-mode .glass-container {

        background: rgba(255, 255, 255, 0.85);

        backdrop-filter: blur(10px);

        box-shadow: 0 25px 45px rgba(0, 0, 0, 0.1), 0 0 0 1px rgba(0,0,0,0.05);

        border: 1px solid rgba(0, 0, 0, 0.07);

        transform: rotateX(0deg) translateZ(10px);

        transition: transform 0.6s ease, background 0.5s ease;

      }
  
      body.light-mode .repo-card {

        background: rgba(255, 255, 255, 0.95);

        color: #000;

        box-shadow: 0 12px 20px rgba(0, 0, 0, 0.1), inset 0 0 12px rgba(0, 0, 0, 0.03);

        transform: perspective(800px) rotateY(1deg);

        transition: all 0.4s ease;

      }
  
      body.light-mode .repo-card:hover {

        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15), inset 0 0 15px rgba(0, 0, 0, 0.05);

        transform: perspective(800px) rotateY(0deg) translateY(-10px);

      }
  
      body.light-mode .search-input {

        background: rgba(0, 0, 0, 0.03);

        color: #000;

        box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.1);

        border: 1px solid rgba(0, 0, 0, 0.05);

      }
  
      body.light-mode .dropdown-menu {

        background-color: #fff !important;

        color: #000;

        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);

      }
  
      body.light-mode .dropdown-item {

        color: #000 !important;

        transition: all 0.3s ease;

      }
  
      body.light-mode .dropdown-item:hover {

        background-color: #eaeaea !important;

        color: #00C9A7 !important;

        transform: translateX(4px);

      }
  


#notification {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 9999;
  display: none;
  min-width: 300px;
  animation: slideIn 0.3s ease-out;
}

@keyframes slideIn {
  from { transform: translateX(100%); }
  to { transform: translateX(0); }
}
#closeBtn {
  font-size: 1.5rem;
  color: #000;
  background: transparent;
  border: none;
}

#closeBtn:hover {
  color: #f00; /* Red color on hover */
}


      /* TOGGLE BUTTON STYLE CHANGE IN LIGHT MODE */

      .theme-toggle-btn {

        transition: background-color 0.3s ease, color 0.3s ease, border 0.3s ease;

        background: linear-gradient(135deg, #2d2d3f, #1e1e2f);

        color: #fff;

        border: 1px solid #444;

      }
  
      body.light-mode .theme-toggle-btn {

        background: linear-gradient(135deg, #f5f5f5, #e0e0e0);

        color: #000;

        border: 1px solid #ccc;

      }



/* full-screen centered flex container */
.spinner-overlay {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.4);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 1050;
  opacity: 0;
  transition: opacity 0.3s ease;
}

/* when we add .visible it will fade in */
.spinner-overlay.visible {
  display: flex;
  opacity: 1;
}






  </style>
  </head>
  <body>
   


  <div class="container py-5">
  <div class="glass-container p-4 mb-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
  <div class="d-flex align-items-center">
  <img src="{{ url_for('static', filename='mwt_logo.png') }}" alt="Logo" class="me-3" style="width: 50px;">
  <div>
  <h2 class="mb-0">Hello, <span class="text-primary">{{ username }}</span></h2>
  <p class=" mb-0">{{ repos|length }} repositories</p>
  <!-- text-muted -->

  <!-- <p><strong>User:</strong> {{ username }}</p>
  <p><strong>Total Repos:</strong> {{ repos|length }}</p>
  <p><strong>Private Repos:</strong> {{ private_repos }}</p>
  <p><strong>Public Repos:</strong> {{ public_repos }}</p> -->
  </div>
  </div><div class="dropdown">
      <button class="btn dropdown-toggle theme-toggle-btn" type="button" id="dropdownMenuButton"
      
                        data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-list fs-3"></i>
      </button>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownMenuButton">
      <li>
      <a class="dropdown-item" href="#" onclick="toggleTheme()">
      <i id="themeIcon" class="bi bi-sun fs-4 me-2"></i>
      <span id="themeText">Light Mode</span>
      </a>
      </li>
      <li><a class="dropdown-item" href="#" onclick="showSettings(event)">‚öôÔ∏è Settings</a></li>
      <li><a class="dropdown-item" href="#" onclick="toggleRepoForm(event)">‚ûï Add Repo</a></li>
      <li><a class="dropdown-item" href="/logout" >üö™ Logout</a></li>
      </ul>
      </div>
      </div>


      
      
  <!-- Toggle Button -->
  
  <!-- Add Repo Form Container (Initially Hidden) -->
<!-- Add Repo Form Container -->
<!-- Add Repo Form Container -->
<!-- Floating notification for success/error messages -->
<!-- <div id="notification" class="alert alert-success" style="position: fixed; top: 20px; left: 20px; z-index: 9999; display: none;">
  <span id="notificationMessage"></span>
</div> -->

<div id="settingsContainer" class="container my-4" style="display: none;">
  <div class="card shadow-sm border-0">
    <div class="card-body position-relative">
      <button type="button" class="btn-close-custom" onclick="hideSettings()">&times;</button>
      <h5 class="card-title mb-4">User & Repository Settings</h5>
      <!-- <p><strong>User:</strong> {{ username }}</p>
      <p><strong>Total repos:</strong> {{ repos|length }}</p> -->

      <h6 class="mt-4">Repositories</h6>
      <ul class="list-group">
        {% for repo in repos %}
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <span>
              <i class="bi bi-folder2-open me-2"></i>
              {{ repo.name }}
              {% if repo.private %}<i class="bi bi-lock ms-1"></i>{% endif %}
            </span>
            <span class="badge bg-secondary">{{ repo.created_at[:10] }}</span>
          </li>
        {% endfor %}
      </ul>
    </div>
  </div>
</div>




<div id="notification" class="alert" style="display: block;">
  <span id="notificationMessage"></span>
</div>






<!-- full-screen overlay with spinner, initially hidden -->
<div id="spinnerOverlay" class="spinner-overlay">
  <div class="spinner-border" role="status">
    <span class="visually-hidden">Loading‚Ä¶</span>
  </div>
</div>







<div id="repoContainer" class="container my-4" style="display: none;">
  <div class="card shadow-sm border-0">
    <div class="card-body position-relative">
      <!-- Close button -->
      <button type="button" 
      id="closeBtn" 
      class="btn-close-custom" 
      aria-label="Close form"
      onclick="toggleRepoForm(event)">
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <line x1="18" y1="6" x2="6" y2="18"></line>
  <line x1="6" y1="6" x2="18" y2="18"></line>
</svg>
</button>

<style>
.btn-close-custom {
position: absolute;
top: 1rem;
right: 1rem;
padding: 0.5rem;
border: none;
background: transparent;
color: rgba(255, 255, 255, 0.8);
cursor: pointer;
transition: all 0.3s ease;
border-radius: 50%;
width: 40px;
height: 40px;
display: flex;
align-items: center;
justify-content: center;
}

.btn-close-custom:hover {
background: rgba(255, 255, 255, 0.1);
transform: rotate(90deg) scale(1.1);
color: #ff6b6b;
}

.btn-close-custom svg {
filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
}

.btn-close-custom:hover svg {
stroke: #ff6b6b;
}

/* Light mode styles */
body.light-mode .btn-close-custom {
color: rgba(0, 0, 0, 0.7);
}

body.light-mode .btn-close-custom:hover {
background: rgba(0, 0, 0, 0.05);
color: #ff4757;
}

/* Animation */
@keyframes closeBtnEntrance {
from { transform: scale(0); opacity: 0; }
to { transform: scale(1); opacity: 1; }
}

.btn-close-custom {
animation: closeBtnEntrance 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}
</style>
      <h5 class="card-title mb-4">Create New Repository</h5>
      <form id="repoForm" action="/add-repo" method="POST" enctype="multipart/form-data">
        <div class="mb-3">
          <label for="repoName" class="form-label">Repository Name <span class="text-danger">*</span></label>
          <input type="text" name="repoName" id="repoName" class="form-control" required placeholder="Enter repository name">
        </div>
        <div class="mb-3">
          <label for="repoDescription" class="form-label">Description</label>
          <textarea name="repoDescription" id="repoDescription" class="form-control" rows="3" placeholder="Short description..."></textarea>
        </div>
        <div class="mb-3">
          <label for="repoVisibility" class="form-label">Repository Visibility <span class="text-danger">*</span></label>
          <select name="repoVisibility" id="repoVisibility" class="form-control" required>
            <option value="public">Public</option>
            <option value="private">Private</option>
          </select>
        </div>
        <div class="mb-3">
          <label for="repoFolder" class="form-label">Upload Folder<span class="text-danger">*</span></label>
          <input type="file" name="repoFolder[]" id="repoFolder" webkitdirectory directory multiple required>
        </div>
        
        <!-- Commit Message -->
        <div class="mb-3">
          <label for="commitMessage" class="form-label">Commit Message<span class="text-danger">*</span></label>
          <input type="text" name="commitMessage" id="commitMessage" class="form-control" required>
        </div>
        
        <div class="text-end">
          <button type="submit" class="btn btn-primary">Create & Upload</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- <script>
  // Handle form submission with JavaScript to prevent page reload
  document.getElementById('repoForm').addEventListener('submit', function(e) {
  e.preventDefault();  // Prevent page reload

  const form = new FormData(this);

  // ‚úÖ Show loading message
  const notification = document.getElementById('notification');
  const notificationMessage = document.getElementById('notificationMessage');
  notification.classList.remove('alert-danger', 'alert-success');
  notification.classList.add('alert-info');
  notificationMessage.textContent = 'Uploading, please wait...';
  notification.style.display = 'block';

  fetch('/add-repo', {
    method: 'POST',
    body: form
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      notification.classList.remove('alert-info', 'alert-danger');
      notification.classList.add('alert-success');
      notificationMessage.textContent = `Repository '${data.url}' created successfully!`;

      // ‚úÖ Clear the form
      document.getElementById('repoForm').reset();

      // ‚úÖ Hide the form container
      document.getElementById('repoContainer').style.display = 'none';

      // ‚úÖ After 2 seconds, redirect to dashboard
      setTimeout(() => {
        window.location.href = '/home'; // Change to your dashboard URL if needed
      }, 2000);
      
    } else {
      notification.classList.remove('alert-info', 'alert-success');
      notification.classList.add('alert-danger');
      notificationMessage.textContent = `Error: ${data.error}`;
    }

    // Show the updated notification
    notification.style.display = 'block';

    // Hide after 5 seconds (only in case of error)
    setTimeout(() => {
      notification.style.display = 'none';
    }, 5000);
  })
  .catch(error => {
    console.error('Error:', error);
    notification.classList.remove('alert-info', 'alert-success');
    notification.classList.add('alert-danger');
    notificationMessage.textContent = 'Something went wrong. Please try again.';
    notification.style.display = 'block';

    setTimeout(() => {
      notification.style.display = 'none';
    }, 5000);
  });
});

</script> -->


        <!-- Search -->
  <div class="search-container mb-0">
  <input type="text" id="searchInput" class="form-control search-input"

                placeholder="Search repositories..." onkeyup="filterRepos()" />
  </div>
  
        <!-- Repo Grid -->
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 row-cols-xl-4 g-4" id="repoGrid">
          {% for repo in repos %}
            <div class="col repo-item" data-repo-name="{{ repo.name|lower }}">
              <div class="card repo-card h-100">
                {% if repo.private %}
                  <i class="bi bi-lock lock-icon"></i>
                {% endif %}
                
                <div class="card-body d-flex flex-column">
                  <h5 class="card-title mb-3">{{ repo.name }}</h5>
                  
                  <div class="mt-auto">
                    <div class="d-grid gap-2">
                      <a href="/repos/{{ repo.owner.login }}/{{ repo.name }}/contents/" 
                         class="btn btn-sm btn-primary w-100 mb-2">
                        <i class="bi bi-folder2-open me-2"></i>View Contents
                      </a>
                      
                      <!-- Direct Delete Button with repo name in confirmation -->
                      <button class="btn btn-sm btn-outline-danger w-100 delete-btn" 
                              data-repo="{{ repo.name }}"
                              onclick="confirmDelete('{{ repo.name }}')">
                        <i class="bi bi-trash me-2"></i>Delete
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
        
        <script>
// Delete repository handler
async function deleteRepo(repoName) {
  const btn = event.target;
  const card = btn.closest('.repo-item');
  
  // Show loading state
  const originalText = btn.innerHTML;
  btn.innerHTML = '<span class="spinner-border spinner-border-sm"></span> Deleting...';
  btn.disabled = true;

  try {
    const response = await fetch('/delete-repo', {
      method: 'DELETE',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ repo_name: repoName })
    });

    const data = await response.json();

    if (!response.ok) {
      throw new Error(data.message || `Failed to delete ${repoName}`);
    }

    if (data.success) {
      // Verify deletion on GitHub after backend success
      await verifyGitHubDeletion(repoName);
      
      // Remove card from UI
      card.remove();

      // Show spinner overlay (optional)
      const overlay = document.getElementById('spinnerOverlay');
      overlay.classList.add('visible');

      // Reload the page after a short delay
      setTimeout(() => {
        window.location.reload();
      }, 2000);
    } else {
      throw new Error(data.message || `Failed to delete ${repoName}`);
    }
  } catch (error) {
    console.error('Delete error:', error);
    alert(error.message);
    btn.innerHTML = originalText;
    btn.disabled = false;

    // Optionally show the spinner overlay in case of error
    const overlay = document.getElementById('spinnerOverlay');
    overlay.classList.add('visible');

    // Reload after 2 seconds if error occurs
    setTimeout(() => {
      window.location.reload();
    }, 2000);
  }
}

// Verify deletion on GitHub
async function verifyGitHubDeletion(repoName) {
  try {
    const username = '{{ session.user_info.login }}'; // From your template
    const response = await fetch(
      `https://api.github.com/repos/${username}/${repoName}`, 
      {
        headers: {
          'Accept': 'application/vnd.github.v3+json'
        }
      }
    );

    // If the status is 404, repository is deleted
    if (response.status === 404) {
      console.log(`Repository '${repoName}' has been successfully deleted from GitHub.`);
    } else {
      throw new Error(`Repository still exists on GitHub (status: ${response.status})`);
    }
  } catch (error) {
    console.error('Verification error:', error);
    throw error;
  }
}

// Add event listeners to all delete buttons
document.querySelectorAll('.delete-btn').forEach(btn => {
  btn.addEventListener('click', function() {
    const repoName = this.dataset.repo;
    if (confirm(`Permanently delete '${repoName}' from GitHub?`)) {
      deleteRepo(repoName);
    }
  });
});
</script>

       
    <script>


function toggleRepoForm(event) {
    event.preventDefault(); // prevent default link behavior
    const repoContainer = document.getElementById('repoContainer');
    if (repoContainer.style.display === 'none') {
        repoContainer.style.display = 'block';
    } else {
        repoContainer.style.display = 'none';
    }
}

// // Listen for form submit
// document.addEventListener('DOMContentLoaded', function() {
//     const repoForm = document.getElementById('repoForm');
    
//     repoForm.addEventListener('submit', function(event) {
//         event.preventDefault(); // prevent normal form submit (you'll handle manually)

//         // Actually submit the form with AJAX if needed
//         fetch(repoForm.action, {
//             method: 'POST',
//             body: new FormData(repoForm)
//         })
//         .then(response => {
//             if (response.ok) {
//                 // If success
//                 showNotification('Repository created successfully!', 'success');

//                 // Hide the form
//                 document.getElementById('repoContainer').style.display = 'none';

//                 // Reset form fields
//                 repoForm.reset();
//             } else {
//                 // If error
//                 showNotification('Failed to create repository.', 'danger');
//             }
//         })
//         .catch(error => {
//             console.error('Error:', error);
//             showNotification('Something went wrong!', 'danger');
//         });
//     });
// });

// // Notification function
// function showNotification(message, type) {
//     const notification = document.getElementById('notification');
//     const notificationMessage = document.getElementById('notificationMessage');

//     notificationMessage.textContent = message;
//     notification.className = `alert alert-${type}`;
//     notification.style.display = 'block';

//     setTimeout(() => {
//         notification.style.display = 'none';
//     }, 3000); // Hide after 3 seconds
// }


      // Load saved theme
      function toggleTheme() {

  const currentTheme = localStorage.getItem('theme');

  if (currentTheme === 'dark') {

    setLightMode();

  } else {

    setDarkMode();

  }

  }



  function showSettings(event) {
    event.preventDefault();
  document.getElementById('settingsContainer').style.display = 'block';
  // hide the repo form if it‚Äôs open
  document.getElementById('repoContainer').style.display = 'none';
}

function hideSettings() {
  document.getElementById('settingsContainer').style.display = 'none';
}


  // Function to set light mode

  function setLightMode() {

  document.body.classList.add('light-mode');

  localStorage.setItem('theme', 'light');

  document.getElementById('themeIcon').classList.replace('bi-sun', 'bi-moon');

  document.getElementById('themeText').textContent = 'Dark Mode';

  }
  document.getElementById('closeBtn').addEventListener('click', function() {
  document.getElementById('repoContainer').style.display = 'none';
});

  // Function to set dark mode

  function setDarkMode() {

  document.body.classList.remove('light-mode');

  localStorage.setItem('theme', 'dark');

  document.getElementById('themeIcon').classList.replace('bi-moon', 'bi-sun');

  document.getElementById('themeText').textContent = 'Light Mode';

  }

  // Load saved theme on page load

  document.addEventListener('DOMContentLoaded', () => {

  const savedTheme = localStorage.getItem('theme');

  if (savedTheme === 'light') {

    setLightMode();

  } else if (savedTheme === 'dark') {

    setDarkMode();

  }

  });
  
      
      function filterRepos() {

        const input = document.getElementById('searchInput');

        const filter = input.value.toLowerCase();

        const repoItems = document.getElementsByClassName('repo-item');
  
        for (const item of repoItems) {

          const repoName = item.dataset.repoName;

          item.style.display = repoName.includes(filter) ? 'block' : 'none';

        }

      }
  </script>
<!-- 
<script>
  document.getElementById('repoForm').addEventListener('submit', function(e) {
    e.preventDefault();
  
    const form = new FormData(this);
    const repoContainer = document.getElementById('repoContainer');
    const notification = document.getElementById('notification');
    
    // Show loading state
    notification.classList.add('alert-info');
    notification.textContent = 'Creating repository...';
    notification.style.display = 'block';
  
    fetch('/add-repo', {
      method: 'POST',
      body: form
    })
    .then(response => response.json())
    .then(data => {
      // Always hide the form regardless of success/failure
      repoContainer.style.display = 'none';
      
      if (data.success) {
        notification.classList.remove('alert-info', 'alert-danger');
        notification.classList.add('alert-success');
        notification.textContent = ` Repository created: ${data.url}`;
        
        // Refresh the page after 2 seconds to show new repo
        setTimeout(() => window.location.reload(), 2000);
      } else {
        notification.classList.remove('alert-info', 'alert-success');
        notification.classList.add('alert-danger');
        notification.textContent = ` Error: ${data.error}`;
      }
      
      // Auto-hide notification after 5 seconds
      setTimeout(() => {
        notification.style.display = 'none';
      }, 5000);
    })
    .catch(error => {
      repoContainer.style.display = 'none';
      notification.classList.add('alert-danger');
      notification.textContent = ' Network error - Please try again';
      setTimeout(() => {
        notification.style.display = 'none';
      }, 5000);
    });
  });
  </script> -->
<script>

document.getElementById('repoForm').addEventListener('submit', function(e) {
  e.preventDefault();
  
  const form = new FormData(this);
  const repoContainer = document.getElementById('repoContainer');
  const notification = document.getElementById('notification');
  
  // Show loading state
  notification.classList.add('alert-info');
  notification.textContent = 'Creating repository...';
  notification.style.display = 'block';
  
  // Hide the form after submission to prevent multiple submissions
  repoContainer.style.display = 'none';

  fetch('/add-repo', {
    method: 'POST',
    body: form
  })
  .then(response => response.json())
  .then(data => {
    // Always hide the form regardless of success/failure
    if (data.success) {
      notification.classList.remove('alert-info', 'alert-danger');
      notification.classList.add('alert-success');
      notification.textContent = `Repository created: ${data.url}`;
  
      // Clear the form after success
      document.getElementById('repoForm').reset();

      // Redirect to dashboard.html after 2 seconds
      // setTimeout(() => {
      //   window.location.reload (); // Navigate to dashboard.html
      // }, 2000);

      if (data.success) {
  // ‚Ä¶ your existing success handling ‚Ä¶

  // show spinner overlay with fade-in
  const overlay = document.getElementById('spinnerOverlay');
  overlay.classList.add('visible');

  // then reload after 2s
  setTimeout(() => {
    window.location.reload();
  }, 2000);
}





    } else {
      notification.classList.remove('alert-info', 'alert-success');
      notification.classList.add('alert-danger');
      notification.textContent = `Error: ${data.error}`;
    }
  
    // Auto-hide notification after 5 seconds
    setTimeout(() => {
      notification.style.display = 'none';
    }, 5000);
  })
  .catch(error => {
    // Handle network error
    repoContainer.style.display = 'block';  // Show form back in case of error
    notification.classList.add('alert-danger');
    notification.textContent = 'Network error - Please try again';
    setTimeout(() => {
      notification.style.display = 'none';
    }, 5000);
  });
});

// Optional: Add a toggle to show the form again after repo creation
document.getElementById('toggleForm').addEventListener('click', function() {
  const repoContainer = document.getElementById('repoContainer');
  repoContainer.style.display = (repoContainer.style.display === 'none') ? 'block' : 'none';
});


</script>

</body>
  </html>

  

